{% extends "base.html" %}

{% block content %}

<div class="container p-3 my-3 border mt-3 rounded">
    <div class="row">
        <div class="col-sm">
            {% for user in user %}
            <h2>The Messenger - {{ user }}</h2>
            {% endfor %}

            {% for erro in error %}
            <h3>{{ erro }}</h3>
            {% endfor %}
        </div>
        <div class="row justify-content-end">
            <div class="col-sm">
                <a href="/logout/">
                    <button type="button" class="btn btn-danger">LOGOUT</button>
                </a>
            </div>
        </div>
    </div>
</div>
<div class="container border rounded">
    {% for friend in friendsPA %}
    <div class="row" style="margin-top: 1%; margin-bottom: 1%;">
        <div class="col-6">
            <h5 style="color: blue;">Usu치rio: {{ friend.username }} - Deseja ser seu amigo! </h5>
        </div>
        <div class="col-1">
            <a href="/friend/?id={{ friend.id }}&op=apr"><button type="button"
                    class="btn btn-success">Aceitar</button></a>
        </div>
        <div class="col-1">
            <a href="/friend/?id={{ friend.id }}&op=rec"><button type="button"
                    class="btn btn-danger">Recusar</button></a>
        </div>
    </div>
    {% endfor %}

    {% for friend in friendsAG %}
    <div class="row" style="margin-top: 1%; margin-bottom: 1%;">
        <div class="col-">
            <h5 style="color: green;">Aguardando pedido de aceite de amizade do Usu치rio: {{ friend.friend_id.username }}
            </h5>
        </div>
    </div>
    {% endfor %}

    {% for friend in friendsA %}
    <div class="row" style="margin-top: 1%; margin-bottom: 1%;">
        <div class="col-6">
            <h5 style="color: blue;">Usu치rio: {{ friend.friend_id.username }} - Aceitou seu pedido de amizade </h5>
        </div>
        <div class="col-1">
            <a href="/index/?id={{ friend.friend_id.id }}&op=ok"><button type="button"
                    class="btn btn-primary">Confirmar</button></a>
        </div>
    </div>
    {% endfor %}

    {% for friend in friendsR %}
    <div class="row" style="margin-top: 1%; margin-bottom: 1%;">
        <div class="col-6">
            <h5 style="color: red;">Usu치rio: {{ friend.friend_id.username }} - Recusou seu pedido de amizade</h5>
        </div>
        <div class="col-1">
            <a href="/index/?id={{ friend.friend_id.id }}&op=okR"><button type="button"
                    class="btn btn-warning">Confirmar</button></a>
        </div>
    </div>
    {% endfor %}

</div>

<div class="container border rounded">
    <div class="row">
        <div class="col-4 border rounded">
            <div class="row text-center">
                <form action="/find/" method="post">{% csrf_token %}
                    <div class="row">
                        <div class="col-10">
                            <input type="text" , class="form-control" id="buscar" name="buscar"
                                placeholder="Buscar Amigos">
                        </div>
                        <div class="col-2">
                            <button type="submit" class="btn btn-success">Buscar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="col-8 border rounded">
            <div class="row">
                <div class="col-3">
                    Resultado da busca:
                </div>
                <div class="col-5">
                    {% for user in users %}
                    <div class="row">
                        <div class="col-4">
                            {{ user.username }}
                        </div>
                        <div class="col-2">
                            <a href="/friend/?id={{ user.id }}&op=add">Adicionar</a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="col-4 border rounded" style="height: 200px;">
            <div>
                <h3>Amigos:</h3>

                {% for friend in friends %}
                <div class="row">
                    <div class="col-4" style="margin-top: 2%;">
                        {{ friend.friend_id.username }}
                    </div>
                    <div class="col-4">
                        <input type="hidden" id="myVar" name="variable" value="{{ friend.friend_id.id }}">
                        <button type="button" id="{{ friend.friend_id.username }}" class="btn btn-warning">Conversar</button>
                        <script>
                            $(document).ready(function () {
                                $("#{{ friend.friend_id.username }}").click(function () {
                                    $(function () {
                                        $("#cont-messages").load("messages/?id={{ friend.friend_id.id }}&op=msg");
                                    });
                                })
                            });
                        </script>
                    </div>
                    <div class="col-4">
                        <a href="/friend/?id={{ friend.friend_id.id }}&op=del">Remover</a>
                    </div>
                </div>
                {% endfor %}

            </div>
        </div>
        <div class="col-8 border rounded" style="height: 200px;">
            <div>
                <h3>
                    Coluna de Mensagens
                    <div id="cont-messages">
                        
                    </div>
                </h3>
            </div>
        </div>
    </div>
    {% endblock content %}